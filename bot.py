
import logging
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, filters, ContextTypes

# Настройка логирования
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)

# Описания чисел богатства
descriptions = {
    1: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «1»

Независимые идеи и оригинальные проекты – это для Вас! Хорошо получится иметь свою частную практику или бизнес (ИП).

Если работа по найму – то лучше трудиться не в большом коллективе над общим делом, а заниматься отдельно частью проекта в индивидуальном порядке или в отдельном кабинете (помещении). Еще один вариант: выбирать «свободные» профессии.

Если все же достаточно большой коллектив и огромное офисное помещение (цех) – это Ваша обычная атмосфера трудовых будней, тогда лучше выбрать какую-нибудь творческую сферу для применения своих талантов.

Если «загоритесь» идеей сделать карьеру – это у Вас получится достаточно быстро, главное – не раздумывайте и не бойтесь, когда Вам предложат повышение по должности или новый выгодный проект, берите сразу ответственность на себя, тогда успех будет сопутствовать Вам всегда и во всем.""",
    2: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «2»

Наверняка, Вы – человек достаточно далёкий от коммерческой деятельности, как таковой. Ваш путь достижения успеха в жизни – работа в коллективе, где каждый сотрудник находится в дружеских отношениях с другими коллегами.

Если Вы работаете в большой компании (предприятии), то лучше выбрать для себя рабочее место в одном из филиалов, нежели в головном офисе и в непосредственной близости от начальства.

Душевное спокойствие и гармоничная атмосфера являются для Вас важными составляющими личного успеха.

Устраиваясь на работу, меняя место работы или начиная новое дело, предварительно убедитесь, что коллектив, в котором Вам предстоит работать, достаточно сплочён и в нём соблюдается не только корпоративная этика, но также царит атмосфера уважения и взаимопомощи.

Познакомьтесь лично с будущими сослуживцами – если общение с ними окажется приятным для Вас, то сможете быстро пойти вверх по карьерной лестнице, если нет – не раздумывайте, ищите другой коллектив.""",
    3: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «3»

Как правило, Вы без особых усилий притягиваете к себе возможности хорошо заработать, деньги сами норовят попасть к Вам в руки.

Вам легко брать займы, оформлять кредиты, друзья довольно охотно одалживают Вам деньги, возможно даже получение наследства и поддержка разного рода меценатов.

Скорее всего, у Вас даже есть «высокие» покровители, которые оказывают Вам протекцию.

Если сами решили взяться за дело, выбирайте сферы деятельности, связанные с социальной активностью, привлечением к себе внимания, любым творчеством, преподавательской деятельностью, проявлением инициативы и активным участием в жизни коллектива и общества в целом.

Также хорошо подойдет любая занятость, способствующая улучшению общего качества жизни, салоны СПА, пищевые добавки, косметика; а также связанная со всяческими жизненными удовольствиями, развлечениями, местами отдыха.""",
    4: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «4»

Стабильный достаток, устойчивое благосостояние, привычный и надёжный уровень заработка – с таким денежным потоком работает энергетика четвёрок.

Применяйте Вашу способность всё скрупулёзно анализировать, выявлять детали и закономерности, обращать внимание на мелочи.

Ваш подход должен быть методичным (шаг за шагом) и не суетливым (сегодня одно – завтра другое). Такое отношение к делам может выдвинуть Вас в ряд ведущих диагностов, критиков, экономистов, контролеров и даже эзотериков.

Что же касается возможной сферы деятельности, то наибольший доход Вам принесут фирмы, которые выпускают предметы жизненного обихода, - от дорогостоящего антиквариата до фабрик по пошиву одежды или изготовлению одноразовой посуды.""",
    5: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «5»

Проявляйте такие качества, как быстрота мышления, скорость реакции, способность принимать эффективные решения в стрессовой ситуации.

Постарайтесь не ввязываться в споры и выяснения вопросов «кто прав – кто виноват», несмотря на то, что Вы почти наверняка способны выйти победителем из любых словесных баталий.

Ищите применение своим способностям там, где постоянно царит движение, перестановки, возникают и обрабатываются новые идеи. Такие сферы жизни могут принести Вам хорошие дивиденды, тут всё зависит только от Вашей расторопности.""",
    6: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «6»

«Деньги лежат рядом с Вами!» Используйте врождённое чувство стиля и гармонии, умение быть утонченным и подкованным в вопросах развития искусства, музыки, театра, литературы.

Для Вас благоприятно получать образование, основное или дополнительное, в областях, связанных с видением прекрасного, артистизмом, творческим самовыражением, красотой слова, пропорций, форм.""",
    7: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «7»

Как правило, духовный рост для Вас важнее, чем рост Вашего благосостояния. Однако у Вас однозначно присутствуют способности, которые могут принести Вам хорошие деньги.

Особенно хорошо Вам подойдут любые сферы деятельности, связанные с исследованиями – историческими, лабораторными, научными, в области человеческой психологии.""",
    8: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «8»

Восьмёрка в нумерологии считается денежным числом. Но тут, как на горках – то вершина успеха, то падение в финансовую пропасть.

Главное - не сомневайтесь, Вы - выберетесь и снова окажетесь на Олимпе.""",
    9: """Число вашего богатства
ОБРЕТЕНИЕ БОГАТСТВА ЧИСЛОМ «9»

Судьба благосклонна к Вам и даст столько денег, сколько будет необходимо для развития того дела или проекта, которому Вы отдаёте всю свою энергию.

Вы – очень многогранная личность, поэтому важно не разбрасываться своим вниманием, временем и усилиями и выбрать что-то одно, иначе рискуете всё потерять."""
}

# Функции расчета
def get_sum_of_digits(num):
    while num > 9:
        num = sum(int(digit) for digit in str(num))
    return num

def get_name_value(name):
    char_map = {
        'А': 1, 'И': 1, 'С': 1, 'Ъ': 1,
        'Б': 2, 'Й': 2, 'Т': 2, 'Ы': 2,
        'В': 3, 'К': 3, 'У': 3, 'Ь': 3,
        'Г': 4, 'Л': 4, 'Ф': 4, 'Э': 4,
        'Д': 5, 'М': 5, 'Х': 5, 'Ю': 5,
        'Е': 6, 'Н': 6, 'Ц': 6, 'Я': 6,
        'Ё': 7, 'О': 7, 'Ч': 7,
        'Ж': 8, 'П': 8, 'Ш': 8,
        'З': 9, 'Р': 9, 'Щ': 9
    }
    return sum(char_map.get(char.upper(), 0) for char in name)

# Основная логика обработки сообщений
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    text = update.message.text
    try:
        birthdate, fullname = text.split(" ", 1)
        birth_sum = get_sum_of_digits(sum(int(digit) for digit in birthdate))
        name_sum = get_sum_of_digits(get_name_value(fullname))
        wealth_number = get_sum_of_digits(birth_sum + name_sum)
        response = f"Ваше число богатства: {wealth_number}\n\n{descriptions[wealth_number]}"
    except Exception as e:
        response = "Ошибка! Проверьте ввод. Пример: '17 Юлия'."
    
    await update.message.reply_text(response)

# Запуск бота
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    await update.message.reply_text("Привет! Введите данные в формате 'дата имя'. Пример: '17 Юлия'.")

def main():
    token = "8134896122:AAHlr-bIUi3Jo0WQdeLhgMoXwM8akp0nyFY"
    application = ApplicationBuilder().token(token).build()

    application.add_handler(CommandHandler("start", start))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    application.run_polling()

if __name__ == "__main__":
    main()
